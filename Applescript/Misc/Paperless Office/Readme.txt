OCR This AppleScripts* Updated April 2011 *Scripts written by Joe Kissell <jk@alt.cc> • http://joekissell.com/For further information, please see:"The real paperless office," Macworld, November 2007 (http://www.macworld.com/article/60229/2007/10/nov07geekfactor.html)"Update: The paperless office," Macworld, November 2008 (http://www.macworld.com/article/137091/2008/11/paperlessoffice.html)"Take Control of Your Paperless Office" (http://www.takecontrolbooks.com/paperless-office)About the Scripts-----------------If you're using Acrobat Standard, Acrobat Pro, PDFpen, PDFpenPro, or Readiris Pro for OCR, the easiest way to automate the process of OCR'ing new scans is with one of these AppleScripts.Because Acrobat's support for AppleScript is limited (and Readiris's support for AppleScript is virtually nonexistent), the scripts for those apps use UI scripting for some tasks. That means instead of sending commands directly to the applications in the background, they must make the application believe that menu commands have been chosen, buttons clicked, and so on. Therefore, you can't be doing other activities while these scripts run, because that may prevent the right controls from being visible to the script at the right time.In order for UI scripting to work, you must enable access for assistive devices. To do so, go to the Universal Access pane of System Preferences and make sure "Enable access for assistive devices" is checked at the bottom of the window. The scripts check for this setting and alert you if it's incorrect.Installing the Scripts----------------------Copy all the scripts into /Library/Scripts/Folder Action Scripts. Then follow the steps appropriate to your version of Mac OS X:Snow Leopard (10.6):1. Right-click (Control-click) on the folder where your scanner stores new scans, and from the contextual menu that appears, choose Services > Folder Actions Setup. Folder Actions Setup opens.2. In the dialog that appears automatically, select the script you want to use (for example, "OCR This (PDFpen & PDFpenPro)") and click Attach.3. Make sure Enable Folder Actions is checked at the top of the Folder Actions Setup window.4. Quit Folder Actions Setup.Leopard (10.5):1. Right-click(Control-click) on the folder where your scanner stores new scans, and from the contextual menu that appears, choose More > Enable Folder Actions.2. Right-click (Control-click) the same folder again and choose More > Attach A Folder Action.3. In the window that appears, navigate to the script you want to attach (remember, it's in /Library/Scripts/Folder Action Scripts), select it, and click Choose.4. Close the window.Thereafter, whenever you scan a new document and it appears in this folder, the AppleScript will activate automatically, opening the scanned file in the appropriate application and activating the program's OCR function.The Acrobat Scripts-------------------This package contains two scripts for Acrobat:OCR This (Acrobat).scptOCR This (Acrobat) with Save As.scptThese two scripts have been updated to work with Acrobat Standard version 7 and Acrobat Pro versions 7, 8, 9, and X - without requiring any editing. (Adobe Reader doesn't have OCR capabilities, alas, so you must use either the Standard or Pro versions.) If you have more than one version of Acrobat Standard or Acrobat Pro installed, the script automatically uses the newest version.NOTE: Because Acrobat Pro X has a fundamentally new interface, it required extensive rethinking of the AppleScript; read "Acrobat Pro X and OCR AppleScripts" just below for further details.Before you can use either of these scripts, you must configure Acrobat's OCR settings as described in "The real paperless office" (http://www.macworld.com/article/60229/2007/10/nov07geekfactor.html). Note the following changes, though:• To adjust OCR settings in Acrobat Pro X, click Tools, then Recognize Text, then In This File.• In Acrobat Pro 9 and X, another option is available in the Recognize Text - Settings dialog box. In lieu of my earlier recommendation to choose Searchable Image (Exact) from the PDF Output Style pop-up menu, you can opt for ClearScan, which may reduce file size by embedding one or more synthesized fonts in your document that approximate the look of its existing fonts, while storing a lower-resolution version of the scanned image itself. If you're unsure which you might prefer, try duplicating a scanned PDF and performing the text recognition with both settings, and then open the resulting files to see how they look.Here's what the Acrobat scripts do:OCR This (Acrobat): This script causes versions of Acrobat prior to X to recognize the text in PDF documents and then save the file (with the existing name, in the existing location) and close it with no need for interaction at all. For Acrobat Pro X, it runs the "OCR This" Action (see "Acrobat Pro X and OCR AppleScripts," below), after first adding the Action if necessary.OCR This (Acrobat) with Save As: This script causes versions of Acrobat <i>prior to X</i> to recognize the text and then prompt you to enter a name and select a location; after saving the file, the script then instructs Acrobat to close the window. (There may be a very brief delay before the window closes.) For Acrobat Pro X,  it runs the "OCR This" Action (see "Acrobat Pro X and OCR AppleScripts," below), after first adding the Action if necessary. With this script, the original file remains in the folder to which you've attached the folder action; you can later delete it manually if you wish.** WARNING: Do not save the file in the folder to which the OCR This folder action is attached! If you do, this will trigger the script to run again on the new file. **Acrobat Pro X and OCR AppleScripts-----------------I had hoped that I could simply modify my earlier "OCR This (Acrobat)" scripts to work the same way with Acrobat Pro X as they did with versions 7, 8, and 9. However, Adobe made such dramatic (and, in my opinion, unfortunate) changes in the design of Acrobat Pro X that I was forced to rethink my approach entirely.Incredibly, Acrobat Pro X takes a massive step backward in scriptability - and that's saying something, because earlier versions were barely scriptable at all. Adobe has implemented an entirely new user interface in Acrobat Pro X that is largely invisible to Apple's Accessibility API. This means all the tricks I used previously to work around Acrobat's lack of scriptability no longer function. I not only can't tell Acrobat to run OCR directly, I also can't tell it to choose a menu command to run OCR (since there is no longer any such command), and I can't even use UI scripting to tell AppleScript to pretend to be a mouse clicking controls on the screen, because the controls aren't standard UI elements.After several hours of hair-pulling, I finally came up with a hack that should, for most users anyway, get fairly close to the results I had earlier. I'll be the first to admit that this hack is ugly and fragile, and I can't guarantee that it will work for you, but it did work for me on two Macs (both running Snow Leopard), and I offer it here entirely AS IS.Here's how it works.One of the new features in Acrobat Pro X is Actions - configurable processes that perform repetitive behaviors, vaguely like Automator actions (but not nearly as good). It turns out that you can create an Action that performs OCR, and then you can use UI scripting to run that Action. What's more, I was able to automate the creation of (a basic version of) a suitable Action using UI scripting. So, although it happens in a roundabout way, I can approximate the end result of getting an AppleScript to perform OCR in Acrobat Pro X.As created by either of my scripts, the "OCR This" Action prompts you to choose a file name and location for saving the searchable file. I would have liked, when creating the Action, to specify further options, such as whether to save the file in place or prompt for a new name and location. And in theory I could have used keystrokes to "walk" down pop-up menus to do just that. Alas, those menus get keyboard focus only when the pointer is over the Create New Action window, and that's something I can't guarantee with plain-vanilla AppleScript (moving the pointer requires a third-party AppleScript addition, and odds are the average user won't have that installed).So, after running the Action once (perhaps on a test scan), I suggest that you follow these steps to tweak the Action's behavior:1. In Acrobat Pro X, choose File > Action Wizard > Edit Actions.2. Select OCR This and click Edit.3. To change OCR settings, click the Options button next to "Recognize Text (using OCR)."   • Set the Primary OCR Language to the language that most commonly appears in your documents (most likely "English (US)").   • Set PDF Output Style to either "Searchable Image (Exact)" or "ClearScan" (described elsewhere in this document), as you prefer.   • If you want to reduce the resolution of scanned images as you apply OCR (to reduce the file size, at the expense of sharpness), choose a setting lower than 600 dpi from the Downsample To pop-up menu.4. To make the Action save the file in place (rather than prompting you with a Save As dialog), choose The Same Folder Selected at Start from the Save To pop-up menu. Alternatively to specify another folder, choose A Folder on My Computer, navigate to a folder, and click Choose.The PDFpen/PDFpenPro Script-------------------This package contains a script for PDFpen and PDFpenPro:OCR This (PDFpen & PDFpenPro).scptSmile Software's PDFpen and PDFpenPro offer OCR capabilities, but unlike Acrobat and Readiris, both versions of PDFpen offer native AppleScript support for OCR, so no UI scripting is required. Nevertheless, they currently can't be configured to perform OCR with no user intervention at all when opening files (it always takes at least one click), so if you want to use them in an automated fashion for OCR, this script can help.This script works with either version of the PDFpen software (version 5 or later), without requiring any modification. However, for best results I suggest making one small change in PDFpen's settings before using the script:1. Choose either PDFpen > Preferences or PDFpenPro > Preferences.2. Click OCR.3. Uncheck the Prompt for OCR When Opening a Scanned Document checkbox.This may seem counterintuitive, but if you leave that checked, then whenever the script runs automatically on a newly scanned document, PDFpen will display a dialog asking if you want to perform OCR on it. That isn't actually a problem - the script still works - but there'll be a delay of a few seconds, and that dialog (and the beep that sounds when it appears) may be confusing and distracting.Once PDFpen is configured, scan a document (or drop an already-scanned document into your designated scans folder) to try the script.The Readiris Script-------------------This package also contains a script for Readiris Pro:OCR This (Readiris Pro).scptThis script has been tested with Readiris Pro 11.6.3. I can't guarantee how well it will work with earlier or newer versions.Before you can use this script, you must set up Readiris in a particular way. Follow these steps:1. In the Settings: Document Type menu, make sure Text is checked; if not, select it.2. Choose Settings: Text Format.3. From the Format pop-up menu at the top of the window, choose PDF. From the pop-up menu next to it, choose Image-Text.4. Uncheck "Embed fonts" and "Create bookmarks."5. Check "Ask file name and location."6. Leave the other settings in this dialog as they are and click on OK.7. Choose Settings: Save as Default. (That way, these settings should stick when you use Readiris Pro again.)Now, when a new PDF file appears in your scans folder, the script causes Readiris to open the file, recognize the text in it, and save it as a PDF; you're prompted to enter a name and select a location. (Unfortunately, because of Readiris's poor AppleScript support, I was unable to find a good way to avoid this need for interaction.) After you save the file, Readiris creates a new document (which clears all the existing scanned pages from its list).NOTE: If you happened to have any pages open in Readiris before running a script, the script will close them (so as to avoid adding extra pages to your PDFs). Therefore, before doing any scanning, make sure you've saved anything you were previously working on.